/* TaskMaster Pro Enhanced CSS (iOS 26 + HyperOS 3)
   Glassmorphism + Accessibility + Performance + Motion/Transparency Controls
   Author: Comet Assistant
*/
/* ------------------------------
   0) CSS Reset & Variables
-------------------------------- */
:root {
  /* Core palette */
  --bg: #0b1020;           /* dark base */
  --bg-2: #0b1226;         /* dark alt */
  --fg: #e8f0ff;           /* text on dark */
  --muted: #aab8d8;        /* secondary text */
  --primary: #60a5fa;      /* blue */
  --accent: #a78bfa;       /* purple */
  --success: #22c55e;      /* green */
  --danger: #ef4444;       /* red */
  --warning: #f59e0b;      /* amber */
  --info: #38bdf8;         /* sky */
  
  /* Surfaces */
  --card: rgba(255,255,255,.08);
  --card-strong: rgba(255,255,255,.12);
  --card-soft: rgba(255,255,255,.06);
  --ring: rgba(96,165,250,.35);
  --ring-strong: rgba(96,165,250,.6);
  --shadow: rgba(0,0,0,.35);
  
  /* Effects */
  --blur: 18px;
  --radius-sm: 10px;
  --radius: 14px;
  --radius-lg: 16px;
  --ring-size: 2px;
  --elev-1: 0 6px 18px -6px rgba(0,0,0,.35), inset 0 1px 0 0 rgba(255,255,255,.05);
  --elev-2: 0 12px 32px -10px rgba(0,0,0,.45), inset 0 1px 0 0 rgba(255,255,255,.06);
  --elev-3: 0 18px 48px -12px rgba(0,0,0,.5), inset 0 1px 0 0 rgba(255,255,255,.08);

  /* Typography & spacing */
  --font: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --size-xs: 12px; --size-sm: 14px; --size-md: 16px; --size-lg: 18px; --size-xl: 22px;
  --gap-xs: 6px; --gap-sm: 10px; --gap: 14px; --gap-lg: 18px; --gap-xl: 24px;

  /* Motion */
  --dur-fast: 120ms; --dur: 220ms; --dur-slow: 360ms;
  --ease: cubic-bezier(.2,.6,.2,1);
  --ease-bounce: cubic-bezier(.34,1.56,.64,1);

  /* Accessibility toggles (JS can toggle data-* attributes on <html>) */
  --glass-opacity: .7; /* lowered when prefers-reduced-transparency */
}

/* Light theme overrides */
@media (prefers-color-scheme: light) {
  :root {
    --bg: #f6f7fb;
    --bg-2: #eef1f8;
    --fg: #0e1328;
    --muted: #4b556b;
    --card: rgba(255,255,255,.7);
    --card-strong: rgba(255,255,255,.85);
    --card-soft: rgba(255,255,255,.55);
    --shadow: rgba(14,19,40,.12);
  }
}

/* Optional explicit theme via [data-theme] attribute */
html[data-theme="dark"] { color-scheme: dark; }
html[data-theme="light"] { color-scheme: light; }

/* Reduced motion & transparency support */
@media (prefers-reduced-motion: reduce) {
  :root { --dur-fast: 0ms; --dur: 0ms; --dur-slow: 0ms; }
  * { animation-duration: 0ms !important; transition-duration: 0ms !important; scroll-behavior: auto !important; }
}
@media (prefers-reduced-transparency: reduce) {
  :root { --glass-opacity: .35; --blur: 8px; }
}

/* Normalize */
*, *::before, *::after { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0; font-family: var(--font); font-size: var(--size-md); color: var(--fg); background: radial-gradient(1200px 800px at 10% -10%, rgba(96,165,250,.15), transparent 40%), radial-gradient(1200px 800px at 110% 10%, rgba(167,139,250,.12), transparent 42%), linear-gradient(180deg, var(--bg), var(--bg-2));
  -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizeLegibility; color-scheme: dark light;
}

/* Focus styles (accessible, visible, not ugly) */
:where(a, button, input, textarea, select, [role="button"], [tabindex]) {
  outline: none;
}
:where(a, button, input, textarea, select, [role="button"], [tabindex]):focus-visible {
  box-shadow: 0 0 0 var(--ring-size) var(--ring), 0 0 1px 2px var(--ring-strong);
  border-radius: calc(var(--radius-sm) + 2px);
}

/* Utility classes */
.container { max-width: 1100px; margin: 0 auto; padding: 24px; }
.hidden { display: none !important; }
.mono { font-family: var(--mono); }
.muted { color: var(--muted); }

/* Glass card */
.card {
  background: color-mix(in oklab, var(--card) calc(var(--glass-opacity)*100%), transparent);
  backdrop-filter: blur(var(--blur)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--blur)) saturate(140%);
  border: 1px solid rgba(255,255,255,.12);
  border-radius: var(--radius-lg);
  box-shadow: var(--elev-1);
}
.card.strong { background: color-mix(in oklab, var(--card-strong) calc(var(--glass-opacity)*100%), transparent); box-shadow: var(--elev-2); }
.card.soft { background: color-mix(in oklab, var(--card-soft) calc(var(--glass-opacity)*100%), transparent); }

/* Buttons */
.btn {
  -webkit-tap-highlight-color: transparent;
  display: inline-flex; align-items: center; justify-content: center; gap: 10px;
  padding: 10px 14px; border-radius: var(--radius);
  color: var(--fg); font-weight: 600; letter-spacing: .2px;
  border: 1px solid rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  box-shadow: var(--elev-1);
  transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease), background var(--dur) var(--ease), border-color var(--dur) var(--ease), opacity var(--dur) var(--ease);
}
.btn:hover { transform: translateY(-1px); box-shadow: var(--elev-2); }
.btn:active { transform: translateY(0) scale(.98); box-shadow: var(--elev-1); }
.btn[aria-disabled="true"], .btn:disabled { opacity: .6; pointer-events: none; }

.btn-primary { background: linear-gradient(180deg, color-mix(in oklab, var(--primary) 50%, transparent), color-mix(in oklab, var(--primary) 20%, transparent)); border-color: color-mix(in oklab, var(--primary) 40%, transparent); }
.btn-accent { background: linear-gradient(180deg, color-mix(in oklab, var(--accent) 50%, transparent), color-mix(in oklab, var(--accent) 20%, transparent)); border-color: color-mix(in oklab, var(--accent) 40%, transparent); }
.btn-danger { background: linear-gradient(180deg, color-mix(in oklab, var(--danger) 50%, transparent), color-mix(in oklab, var(--danger) 20%, transparent)); border-color: color-mix(in oklab, var(--danger) 40%, transparent); }
.btn-ghost { background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); }

/* Inputs */
.input, input[type="text"], input[type="date"], textarea, select {
  width: 100%; padding: 10px 12px; border-radius: var(--radius);
  color: var(--fg); background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border: 1px solid rgba(255,255,255,.15);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.04), 0 8px 24px rgba(0,0,0,.12);
  transition: border-color var(--dur) var(--ease), background var(--dur) var(--ease), box-shadow var(--dur) var(--ease);
}
.input::placeholder, input::placeholder, textarea::placeholder { color: color-mix(in oklab, var(--muted) 85%, transparent); }
.input:hover, input:hover, textarea:hover, select:hover { border-color: rgba(255,255,255,.25); }
.input:focus, input:focus, textarea:focus, select:focus { border-color: var(--ring-strong); box-shadow: 0 0 0 2px var(--ring), inset 0 1px 0 rgba(255,255,255,.08), 0 8px 24px rgba(0,0,0,.16); }

/* Date input fixes (cross-browser) */
input[type="date"] { min-height: 42px; position: relative; }
input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(80%); opacity: .85; cursor: pointer; }
input[type="date"]::-webkit-datetime-edit { color: var(--fg); }
input[type="date"]::-webkit-datetime-edit-fields-wrapper { padding: 2px 0; }
input[type="date"]::-webkit-datetime-edit-text { color: var(--muted); }
input[type="date"]::-webkit-datetime-edit-day-field,
input[type="date"]::-webkit-datetime-edit-month-field,
input[type="date"]::-webkit-datetime-edit-year-field { color: var(--fg); }
/* Placeholder for unsupported browsers */
input[type="date"].no-date-support { appearance: none; }

/* Modal */
.modal-backdrop { position: fixed; inset: 0; background: rgba(3,7,18,.55); backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); display: none; }
.modal-backdrop[aria-hidden="false"] { display: block; }
.modal { position: fixed; inset: 0; display: grid; place-items: center; padding: 24px; }
.modal .panel { width: min(560px, 96vw); background: var(--card); border: 1px solid rgba(255,255,255,.12); border-radius: 18px; box-shadow: var(--elev-3); overflow: clip;
  transform: translateY(12px) scale(.98); opacity: 0; transition: transform var(--dur) var(--ease), opacity var(--dur) var(--ease); }
.modal[open] .panel { transform: translateY(0) scale(1); opacity: 1; }
.modal header { display: flex; align-items: center; justify-content: space-between; padding: 16px 18px; gap: 12px; border-bottom: 1px solid rgba(255,255,255,.08); }
.modal .content { padding: 18px; display: grid; gap: 12px; }
.modal footer { padding: 14px 18px; display: flex; justify-content: flex-end; gap: 10px; border-top: 1px solid rgba(255,255,255,.08); }

/* Cancel button UX guarantee */
button.cancel, .btn-cancel { --ring: rgba(148,163,184,.4); --ring-strong: rgba(148,163,184,.6); }
.modal [data-action="cancel"], .modal .btn-cancel { background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); }
.modal:not([open]) { pointer-events: none; }

/* Tabs / Bottom nav */
.navbar { position: sticky; bottom: 0; backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); background: color-mix(in oklab, var(--bg-2) 35%, transparent); border-top: 1px solid rgba(255,255,255,.08); display: grid; grid-template-columns: repeat(5,1fr); gap: 8px; padding: 10px; }
.navbar button, .navbar a { color: var(--muted); padding: 10px; border-radius: 12px; border: 1px solid transparent; transition: color var(--dur) var(--ease), background var(--dur) var(--ease), transform var(--dur) var(--ease); }
.navbar [aria-current="page"], .navbar .active { color: var(--fg); background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.12); box-shadow: var(--elev-1); transform: translateY(-2px); }

/* Lists and items (tasks, cards, chats) */
.list { display: grid; gap: 12px; }
.item { display: grid; gap: 8px; padding: 12px; border-radius: var(--radius-lg); background: var(--card); border: 1px solid rgba(255,255,255,.12); box-shadow: var(--elev-1); }
.item:hover { box-shadow: var(--elev-2); transform: translateY(-1px); transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease); }
.item .title { font-size: var(--size-lg); font-weight: 700; letter-spacing: .2px; }
.item .meta { color: var(--muted); font-size: var(--size-sm); display: flex; gap: 10px; align-items: center; }
.item .actions { display: flex; gap: 8px; justify-content: flex-end; align-items: center; }

/* Flashcards grid */
.flashcards { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 14px; align-items: stretch; }
.flashcard { background: var(--card); border: 1px solid rgba(255,255,255,.12); border-radius: 16px; padding: 14px; box-shadow: var(--elev-1); display: grid; gap: 10px; }
.flashcard .q { font-weight: 700; }
.flashcard .a { color: var(--muted); }

/* Chat */
.chat { display: grid; gap: 12px; }
.chat .bubble { max-width: 80ch; padding: 10px 14px; border-radius: 14px; border: 1px solid rgba(255,255,255,.1); box-shadow: var(--elev-1); }
.chat .bubble.user { background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)); align-self: end; }
.chat .bubble.ai { background: linear-gradient(180deg, rgba(167,139,250,.18), rgba(167,139,250,.08)); }
.chat .status { color: var(--muted); font-size: var(--size-sm); }

/* Timer (Pomodoro
