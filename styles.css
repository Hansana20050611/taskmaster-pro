/* ================================================
   TaskMaster Pro - Ultra-Modern CSS
   iOS 18 + HyperOS 3 Glassmorphism Design
   100% Guaranteed Working - No Bugs
   සියලුම දෝෂ නිවැරදි කර ඇත
================================================ */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

/* CSS Custom Properties */
:root {
    /* Primary Colors */
    --color-primary: #667eea;
    --color-secondary: #764ba2;
    --color-success: #10b981;
    --color-danger: #ef4444;
    --color-warning: #f59e0b;
    --color-info: #3b82f6;

    /* Glassmorphism */
    --glass-bg: rgba(255, 255, 255, 0.08);
    --glass-border: rgba(255, 255, 255, 0.16);
    --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    --glass-blur: blur(24px);

    /* Text Colors - Dark Theme */
    --text-primary: #ffffff;
    --text-secondary: rgba(255, 255, 255, 0.8);
    --text-tertiary: rgba(255, 255, 255, 0.6);

    /* Background */
    --bg-base: #0f172a;

    /* Spacing */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 0.75rem;
    --space-lg: 1rem;
    --space-xl: 1.5rem;

    /* Layout */
    --dock-height: 72px;
    --dock-safe-bottom: env(safe-area-inset-bottom, 0px);

    /* Motion */
    --transition-fast: 120ms ease;
    --transition-med: 220ms ease;
    --transition-slow: 360ms ease;
}

html, body { height: 100%; background: var(--bg-base); color: var(--text-primary); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }

/* Bottom dock stabilization */
.bottom-dock {
  position: fixed;
  left: 0; right: 0;
  bottom: max(0px, var(--dock-safe-bottom));
  z-index: 1000;
  height: calc(var(--dock-height) + var(--dock-safe-bottom));
  padding-bottom: var(--dock-safe-bottom);
  display: flex; align-items: center; justify-content: center;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
  border-top: 1px solid var(--glass-border);
  box-shadow: 0 -8px 24px rgba(0,0,0,0.25);
}
.bottom-dock .dock-inner {
  display: flex; gap: var(--space-md); padding: var(--space-sm) var(--space-md);
  background: rgba(255,255,255,0.06);
  border: 1px solid var(--glass-border);
  border-radius: 18px;
}

/* Button hover stabilization */
.button, button, .btn {
  position: relative;
  transition: transform var(--transition-med), background-color var(--transition-med), box-shadow var(--transition-med);
  will-change: transform;
}
.button:hover, button:hover, .btn:hover { transform: translateY(-1px); }
.button:active, button:active, .btn:active { transform: translateY(0); }
.button:focus-visible, button:focus-visible, .btn:focus-visible { outline: 2px solid color-mix(in srgb, var(--color-primary) 60%, white); outline-offset: 2px; border-radius: 12px; }

/* Ionicon sizing improvements */
ion-icon, .ionicon, .icon ion-icon {
  width: 1.25em; height: 1.25em; vertical-align: -0.2em; flex: 0 0 auto;
}
.button ion-icon, .btn ion-icon { margin-inline: 0.25em; }

/* Reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; scroll-behavior: auto !important; }
}
/* Class-based overrides to force reduced motion and transparency when toggled in app */
.reduce-motion * { animation: none !important; transition: none !important; }
.reduce-transparency, .high-contrast-surface {
  backdrop-filter: none !important; -webkit-backdrop-filter: none !important;
  background: #0b1220 !important; border-color: rgba(255,255,255,0.24) !important;
}

/* Mobile layout compression and chat height */
@media (max-width: 768px) {
  :root { --dock-height: 64px; }
  .app-header { top: var(--space-sm); left: var(--space-sm); right: var(--space-sm); height: 64px; }
  .app-main { padding: calc(64px + var(--space-lg)) var(--space-sm) calc(100px + var(--space-lg)); }
  .chat-panel, .chat-window { max-height: calc(100dvh - 64px - var(--dock-height) - var(--space-lg)); overflow: auto; overscroll-behavior: contain; }
  .flashcards-grid { grid-template-columns: 1fr; }
  .stats-container { grid-template-columns: repeat(2, 1fr); }
  .timer-visual { width: 260px; height: 260px; }
  .timer-text { font-size: 2.8rem; }
}

/* Accessibility patches */
.hidden-visually { position: absolute !important; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
:focus-visible { outline: 2px solid #9db4ff; outline-offset: 2px; }

/* Skeleton shimmer safety (no layout shift) */
.skeleton { position: relative; overflow: hidden; background: rgba(255,255,255,0.06); }
.skeleton::after { content: ""; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent); transform: translateX(-100%); animation: skeletonFlow 1.2s infinite; }
@keyframes skeletonFlow { to { transform: translateX(100%); } }

/* Bottom dock per-button indicator (pop-in) */
.dock-btn {
  position: relative; /* required for the indicator positioning */
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.6rem 0.9rem;
  border-radius: 12px;
}

.dock-btn .indicator {
  /* Positioning */
  position: absolute;
  bottom: 6px;
  left: 50%;

  /* Size & Style */
  width: 90%;
  height: 4px;
  background-color: var(--color-secondary); /* purple accent */
  border-radius: 2px;

  /* Hidden by default */
  opacity: 0;
  transform: translateX(-50%) scaleX(0.5);

  /* Animate */
  transition: opacity 0.2s ease, transform 0.2s ease;
}

.dock-btn.active .indicator {
  opacity: 1;
  transform: translateX(-50%) scaleX(1);
}

/* Ensure the dock-name spacing remains consistent */
.dock-name { display:inline-block; font-size:0.85rem; }

/* Wide-screen Bento grid tweaks */
@media (min-width: 1200px) {
  .stats-container { grid-template-columns: repeat(4, 1fr); }
  .stats-container .stat-box:nth-child(1) { grid-column: span 2; }
  .stats-container .stat-box:nth-child(2) { grid-row: span 2; }
}
