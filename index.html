<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=5.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#667eea" />
    <title>TaskMaster Pro - AI Study Assistant</title>
    <link rel="stylesheet" href="styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@200..700" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet" />
    <link rel="icon" href="data:image/svg+xml,&lt;svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;text y='.9em' font-size='90'&gt;üéì&lt;/text&gt;&lt;/svg&gt;" />
  </head>
  <body class="dark-theme">
    <!-- iOS Haptic Trigger (hidden) -->
    <input type="checkbox" switch style="display:none;" id="haptic-trigger" />
    <label for="haptic-trigger" id="haptic-label" style="display:none;"></label>

    <!-- Floating App Header -->
    <header class="app-header glass-surface">
      <div class="header-wrapper">
        <div class="app-logo">
          <span class="logo-emoji" aria-hidden="true"><ion-icon name="school-outline"></ion-icon></span>
          <span class="logo-title">TaskMaster Pro</span>
        </div>
        <div class="header-actions">
          <select id="lang-selector" class="header-control" aria-label="Language">
            <option value="en">EN</option>
            <option value="si">‡∑É‡∑í‡∂Ç</option>
          </select>
          <button id="reduce-motion-btn" class="header-control" aria-label="Toggle reduced motion" aria-pressed="false" title="Reduced Motion">
            <ion-icon name="film-outline"></ion-icon>
          </button>
          <button id="reduce-transparency-btn" class="header-control" aria-label="Toggle reduced transparency" aria-pressed="false" title="Reduced Transparency">
            <ion-icon name="sparkles-outline"></ion-icon>
          </button>
          <button id="theme-btn" class="header-control theme-toggle" aria-label="Toggle theme">
            <ion-icon id="theme-icon" name="moon-outline"></ion-icon>
          </button>
        </div>
      </div>
    </header>

    <!-- Main App Content -->
    <main class="app-main">
      <div id="aria-live" aria-live="polite" aria-atomic="true" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;">
        <!-- Screen reader live updates -->
      </div>

      <!-- TAB 1: Tasks Section -->
      <section class="app-view" id="view-tasks">
        <div class="view-header">
          <h2 class="view-title" id="title-tasks">üìù My Tasks</h2>
          <button class="btn-primary" id="btn-add-task">+ New Task</button>
        </div>
        <div class="tasks-wrapper glass-surface">
          <div class="tasks-grid" id="tasks-list"></div>
        </div>
      </section>

      <!-- TAB 2: Generator Section (Flashcards) -->
      <section class="app-view active-view" id="view-generator">
        <div class="view-header">
          <h2 class="view-title" id="title-generator">üé¥ Flashcard Generator</h2>
        </div>
        <div class="generator-panel glass-surface">
          <div class="input-group">
            <label class="input-label" for="fc-subject">Subject</label>
            <select class="input-field" id="fc-subject">
              <option value="Chemistry">Chemistry</option>
              <option value="Physics">Physics</option>
              <option value="Biology">Biology</option>
              <option value="Mathematics">Mathematics</option>
              <option value="Computer Science">Computer Science</option>
            </select>
          </div>
          <div class="input-group">
            <label class="input-label" for="fc-topic">Topic</label>
            <input class="input-field" id="fc-topic" type="text" placeholder="e.g., S-block elements, Newton's Laws" />
          </div>
          <div class="input-group">
            <label class="input-label" for="fc-count">Number of Cards</label>
            <select class="input-field" id="fc-count">
              <option value="5">5 Cards</option>
              <option value="10">10 Cards</option>
              <option value="15">15 Cards</option>
              <option value="20">20 Cards</option>
            </select>
          </div>
          <button class="btn-primary btn-full" id="btn-generate">‚ú® Generate with AI</button>
        </div>
        <div class="flashcards-grid" id="cards-grid"></div>
      </section>

      <!-- TAB 3: AI Chat Section -->
      <section class="app-view" id="view-chat">
        <div class="chat-panel glass-surface">
          <div class="chat-top">
            <h2 class="view-title" id="title-chat">üí¨ AI Study Assistant</h2>
            <select class="input-field" id="chat-subject">
              <option value="General">General</option>
              <option value="Mathematics">Mathematics</option>
              <option value="Physics">Physics</option>
              <option value="Chemistry">Chemistry</option>
              <option value="Biology">Biology</option>
            </select>
          </div>
          <div class="chat-messages" id="chat-messages">
            <div class="chat-msg bot-msg">
              <div class="msg-avatar">ü§ñ</div>
              <div class="msg-bubble">
                Hello! I'm your AI study assistant. Ask me anything about your subjects!
              </div>
            </div>
          </div>
          <div class="chat-bottom">
            <textarea class="chat-textarea" id="chat-input" rows="2" placeholder="Ask a question or describe a problem..."></textarea>
            <button id="btn-send" class="btn-send-chat" aria-label="Send">
              <ion-icon name="send-outline"></ion-icon>
            </button>
          </div>
        </div>
      </section>

      <!-- TAB 4: Timer Section (Pomodoro) -->
      <section class="app-view" id="view-timer">
        <div class="timer-panel glass-surface">
          <div class="timer-visual">
            <svg class="timer-svg" viewBox="0 0 200 200">
              <circle class="timer-track" cx="100" cy="100" r="85"></circle>
              <circle class="timer-path" id="timer-circle" cx="100" cy="100" r="85"></circle>
            </svg>
            <div class="timer-center">
              <div class="timer-text" id="timer-text">25:00</div>
              <div class="timer-status">Focus Session</div>
            </div>
          </div>
          <div class="timer-buttons">
            <button class="btn-timer" id="btn-timer-start">
              <span id="timer-btn-icon"><ion-icon name="play-outline"></ion-icon></span> <span id="timer-btn-text">Start</span>
            </button>
            <button class="btn-timer btn-secondary" id="btn-timer-reset">‚Üª Reset</button>
          </div>
          <div class="timer-details">
            <div class="timer-detail-item">
              <div class="detail-value" id="timer-round">1</div>
              <div class="detail-label">Current Round</div>
            </div>
            <div class="timer-detail-item">
              <div class="detail-value" id="timer-completed">0</div>
              <div class="detail-label">Sessions Done</div>
            </div>
          </div>
        </div>
      </section>

      <!-- TAB 5: Stats Section -->
      <section class="app-view" id="view-stats">
        <div class="view-header">
          <h2 class="view-title" id="title-stats">üìä Your Progress</h2>
        </div>
        <div class="stats-container">
          <div class="stat-box glass-surface">
            <div class="stat-emoji"><ion-icon name="checkmark-done-circle-outline"></ion-icon></div>
            <div class="stat-num" id="stat-tasks">0</div>
            <div class="stat-desc">Tasks Completed</div>
          </div>
          <div class="stat-box glass-surface">
            <div class="stat-emoji"><ion-icon name="layers-outline"></ion-icon></div>
            <div class="stat-num" id="stat-cards">0</div>
            <div class="stat-desc">Cards Learned</div>
          </div>
          <div class="stat-box glass-surface">
            <div class="stat-emoji"><ion-icon name="stopwatch-outline"></ion-icon></div>
            <div class="stat-num" id="stat-hours">0h</div>
            <div class="stat-desc">Study Time</div>
          </div>
          <div class="stat-box glass-surface">
            <div class="stat-emoji"><ion-icon name="flame-outline"></ion-icon></div>
            <div class="stat-num" id="stat-streak">0</div>
            <div class="stat-desc">Day Streak</div>
          </div>
        </div>
      </section>
    </main>

    <!-- Bottom Floating Navigation -->
    <nav class="bottom-dock glass-surface" role="tablist" aria-label="Main navigation">
      <button id="tab-tasks" class="dock-btn" data-tab="tasks" role="tab" aria-selected="false" aria-controls="view-tasks" aria-label="Tasks">
        <span class="dock-emoji" aria-hidden="true"><ion-icon name="create-outline"></ion-icon></span>
        <span class="dock-name">Tasks</span>
      </button>
      <button id="tab-generator" class="dock-btn active-tab" data-tab="generator" role="tab" aria-selected="true" aria-controls="view-generator" aria-label="Generator">
        <span class="dock-emoji" aria-hidden="true"><ion-icon name="sparkles-outline"></ion-icon></span>
        <span class="dock-name">Generator</span>
      </button>
      <button id="tab-chat" class="dock-btn" data-tab="chat" role="tab" aria-selected="false" aria-controls="view-chat" aria-label="Chat">
        <span class="dock-emoji" aria-hidden="true"><ion-icon name="chatbubble-ellipses-outline"></ion-icon></span>
        <span class="dock-name">Chat</span>
      </button>
      <button id="tab-timer" class="dock-btn" data-tab="timer" role="tab" aria-selected="false" aria-controls="view-timer" aria-label="Timer">
        <span class="dock-emoji" aria-hidden="true"><ion-icon name="timer-outline"></ion-icon></span>
        <span class="dock-name">Timer</span>
      </button>
      <button id="tab-stats" class="dock-btn" data-tab="stats" role="tab" aria-selected="false" aria-controls="view-stats" aria-label="Stats">
        <span class="dock-emoji" aria-hidden="true"><ion-icon name="stats-chart-outline"></ion-icon></span>
        <span class="dock-name">Stats</span>
      </button>
    </nav>

    <!-- Loading Spinner Overlay -->
    <div class="loader-screen" id="loader-overlay">
      <div class="loader-spin"></div>
    </div>

    <!-- Ionicons and App Scripts -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="script.js"></script>
  </body>
</html>
